#!/usr/bin/env bash
# installs HAProxy load balancer
sudo apt-get update
sudo apt-get install -y haproxy
echo "
frontend http_front
        bind *:80
        default_backend web_servers

backend web_servers
	mode http
        balance roundrobin
        server web-01 446460-web-01:80 35.175.130.20 check
        server web-02 446460-web-02:80 35.175.63.155 check
" > /etc/haproxy/haproxy.cfg
sudo service haproxy start
sudo service haproxy enable
echo "HAProxy installed and configured successfully"
